# Description of Localized PESE-GC

## Motivation

The original PESE-GC does not localize the probit-space multivariate correlations. As a result, the expanded ensemble have the same probit-space correlations as the original forecast ensemble. Adding localization capabilities opens a pathway for users to improve their ensemble statistics. 

## General Implementation Information
In the original PESE-GC, at all grid locations, the same E matrix is generated by applying linear transforms on random numbers drawn via the **same random number generator seed**. The trick to localize the probit-space multivariate statistics is to have E vary in space by modifying the random number generation process.

The general procedure is as follows:
1) At every grid point, draw a unique set of random numbers through using RNG seeds unique to that grid point. Supposing there are $N_v$ virtual members and $N_f$ forecast members, every grid point will draw $N_v \times N_f$ random numbers.
2) Spatially convolve the random numbers drawn using the localization function as the kernel. Note that this is a spatial convolution, not a convolution along the "random sample" dimension.
3) At every grid point, use the convoluted random numbers to generate matrix E.


## Acceleration via Approximation
The convolutions described earlier are expensive. As such, instead of drawing $N_v \times N_f$ convoluted random numbers per grid point, only 100 such numbers are drawn per grid point. Then, fast Gaussian resampling is used to construct the remaining random numbers. Results look reasonable, so this approximation is acceptable.